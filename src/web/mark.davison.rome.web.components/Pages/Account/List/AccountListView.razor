@attribute [Route(Routes.Accounts)]
@attribute [Route(Routes.AccountsByType)]

@implements IDisposable

<MudStack Row="true" Class="pa-10">
    <MudText Typo="Typo.h4">@ViewModel.Title</MudText>
    <MudTooltip Text="Add">
        <MudIconButton Icon="@Icons.Material.Filled.AddCircle" Variant="Variant.Filled" Color="Color.Primary" Style="min-width: 60px;" OnClick="@AddAccount" />
    </MudTooltip>
</MudStack>
<MudDataGrid Items="@ViewModel.Items" Loading="@ViewModel.AccountsLoading">
    <Columns>
        <TemplateColumn Title="Name">
            <CellTemplate>
                <MudLink Href="@context.Item.Name?.Href">@context.Item.Name?.Text</MudLink>
            </CellTemplate>
        </TemplateColumn>
        @if (Type is null)
        {
            <PropertyColumn Title="Account type" Property="_ => _.AccountType" />
        }
        <PropertyColumn Title="Account number" Property="_ => _.AccountNumber" />
        <PropertyColumn Title="Current balance" Property="_ => _.CurrentBalance" CellStyleFunc="@ViewModel.AmountCellStyleFunc(_ => _.CurrentBalanceAmount)" />
        <PropertyColumn Title="Balance difference" Property="_ => _.BalanceDifference" CellStyleFunc="@ViewModel.AmountCellStyleFunc(_ => _.BalanceDifferenceAmount)" />
        <TemplateColumn Title="Last modified">
            <CellTemplate>
                <MudText>@context.Item.LastModified.ToShortDateString()</MudText>
            </CellTemplate>
        </TemplateColumn>
    </Columns>
</MudDataGrid>